<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lyra | Neural Interface</title>
    <style>
        /* --- CORE STYLES --- */
        body { margin: 0; background: #f0f4f8; font-family: 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; }
        
        /* VIDEO OVERLAY */
        #intro-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        video { width: 100%; height: 100%; object-fit: cover; }
        
        #enter-btn {
            position: absolute; bottom: 20%;
            padding: 15px 40px; font-size: 18px; font-weight: bold;
            color: #00d2ff; background: rgba(0,0,0,0.8);
            border: 2px solid #00d2ff; cursor: pointer;
            display: none; text-transform: uppercase; letter-spacing: 2px;
        }
        #enter-btn:hover { background: #00d2ff; color: black; }

        /* MAIN APP */
        #app-root { display: none; height: 100%; flex-direction: column; opacity: 0; transition: opacity 1s; }
        
        header {
            position: absolute; top: 0; left: 0; width: 100%; height: 70px;
            z-index: 100; display: flex; align-items: center; padding-left: 15px;
        }

        .hamburger { font-size: 28px; cursor: pointer; color: #333; z-index: 200; padding: 10px; }

        /* SIDEBAR */
        #sidebar {
            position: fixed; top: 0; left: -260px; width: 260px; height: 100%;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            z-index: 900; box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        #sidebar.open { left: 0; }
        .sidebar-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .sidebar-item { padding: 15px 20px; border-bottom: 1px solid #f5f5f5; cursor: pointer; color: #555; }

        /* LOGO ANIMATION */
        .logo-container {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            display: flex; align-items: center; gap: 10px;
            transition: all 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            pointer-events: none;
        }
        .logo-img { 
            height: 60px; width: auto; 
            filter: drop-shadow(0 0 10px rgba(0, 210, 255, 0.5));
            animation: slowSpin 8s linear infinite;
        }
        body.active-mode .logo-container { left: 70px; transform: translateX(0); }
        body.active-mode .logo-img { height: 40px; }
        body.thinking .logo-img { animation: fastSpin 0.5s linear infinite; }
        @keyframes slowSpin { 100% { transform: rotate(360deg); } }
        @keyframes fastSpin { 100% { transform: rotate(360deg); } }

        /* CHAT AREA */
        #chat-screen { flex: 1; overflow-y: auto; padding: 90px 20px 110px 20px; display: flex; flex-direction: column; gap: 20px; }
        .msg { padding: 12px 18px; border-radius: 18px; max-width: 80%; font-size: 16px; line-height: 1.4; }
        .msg.user { align-self: flex-end; background: linear-gradient(135deg, #00c6ff, #0072ff); color: white; border-bottom-right-radius: 4px; }
        .msg.bot { align-self: flex-start; background: white; color: #333; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-bottom-left-radius: 4px; }

        /* INPUT AREA */
        footer { 
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(255,255,255,0.85); backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0,0,0,0.05); padding: 15px 20px 5px 20px;
            display: flex; flex-direction: column; align-items: center;
        }
        .input-row { display: flex; width: 100%; gap: 10px; align-items: center; max-width: 800px; }
        input { flex: 1; padding: 12px 20px; border-radius: 30px; border: 1px solid #ddd; font-size: 16px; outline: none; background: white; }
        .icon-btn { width: 45px; height: 45px; flex-shrink: 0; border-radius: 50%; border: none; cursor: pointer; display: flex; justify-content: center; align-items: center; }
        #send { background: #007bff; color: white; }
        #mic-btn { background: #eee; color: #333; }
        .powered-by { font-size: 10px; color: #999; margin-top: 8px; margin-bottom: 5px; letter-spacing: 1px; text-transform: uppercase; }
    </style>
</head>
<body>

    <div id="intro-layer">
        <video id="myVideo" muted playsinline>
            <source src="assets/AI_Video_Generation_LYRA_Logo_Reveal.mp4" type="video/mp4">
        </video>
        <button id="enter-btn">INITIALIZE SYSTEM</button>
    </div>

    <div id="app-root">
        <div id="sidebar">
            <div class="sidebar-header">
                <span style="font-weight:bold; color:#007bff;">LYRA MENU</span>
                <span onclick="toggleSidebar()" style="cursor:pointer; font-size:24px;">&times;</span>
            </div>
            <div class="sidebar-item" onclick="location.reload()">+ New Chat</div>
            <div class="sidebar-item" onclick="alert('Memory Cleared')">Clear Memory</div>
        </div>

        <header>
            <div class="hamburger" onclick="toggleSidebar()">â˜°</div>
            <div class="logo-container">
                <img src="assets/logos/lyra-logo-l-only.png" class="logo-img" id="lyraLogo" alt="L">
                <h2 style="margin:0; opacity:0; transition:0.5s; color:#333;" id="brandText">LYRA</h2>
            </div>
        </header>

        <div id="chat-screen"></div>

        <footer>
            <div class="input-row">
                <button id="mic-btn" class="icon-btn">ðŸŽ¤</button>
                <input type="text" id="userInput" placeholder="Ask Lyra...">
                <button id="send" class="icon-btn">âž¤</button>
            </div>
            <div class="powered-by">POWERED BY LYCEUM CORPORATION</div>
        </footer>
    </div>

    <script>
        /* --- ðŸš€ CONFIGURATION --- */
        // I kept your key here. It looks correct!
        const GEMINI_API_KEY = "AIzaSyB8_Il4NiIR1S212VZS3jhxE1qm60XnPQo"; 

        const video = document.getElementById('myVideo');
        const enterBtn = document.getElementById('enter-btn');
        const input = document.getElementById('userInput');
        const chatBox = document.getElementById('chat-screen');
        const logo = document.getElementById('lyraLogo');
        let hasStarted = false;

        /* VIDEO LOGIC */
        video.play().then(() => { setTimeout(() => enterBtn.style.display = 'block', 2500); })
             .catch(() => { enterBtn.style.display = 'block'; });

        enterBtn.onclick = () => {
            document.getElementById('intro-layer').style.display = 'none';
            document.getElementById('app-root').style.display = 'flex';
            setTimeout(() => document.getElementById('app-root').style.opacity = '1', 100);
            video.pause();
        };

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }

        /* VOICE LOGIC */
        if ('webkitSpeechRecognition' in window) {
            const recognition = new webkitSpeechRecognition();
            recognition.continuous = false; recognition.lang = 'en-US';
            recognition.onresult = (event) => {
                input.value = event.results[0][0].transcript;
                handleSend();
            };
            document.getElementById('mic-btn').onclick = () => recognition.start();
        }

        /* CHAT LOGIC - REVERTED TO GEMINI PRO (STABLE) */
        async function handleSend() {
            const text = input.value.trim();
            if (!text) return;

            if (!hasStarted) {
                document.body.classList.add('active-mode');
                document.getElementById('brandText').style.opacity = '1';
                hasStarted = true;
            }

            addMessage(text, 'user');
            input.value = "";
            document.body.classList.add('thinking');

            let responseText = "";

            try {
                // *** CHANGED TO GEMINI-PRO (Stable) ***
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: text }] }] })
                });

                const data = await response.json();

                if (data.error) {
                    console.error("Gemini Error:", data.error);
                    responseText = "Error: " + data.error.message;
                } else {
                    responseText = data.candidates[0].content.parts[0].text;
                }
            } catch (e) {
                console.error("Network Error:", e);
                responseText = "Connection failed. Check your internet.";
            }

            document.body.classList.remove('thinking');
            addMessage(responseText, 'bot');
        }

        function addMessage(text, type) {
            const div = document.createElement('div');
            div.className = `msg ${type}`;
            div.textContent = text;
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        document.getElementById('send').onclick = handleSend;
        input.addEventListener('keypress', (e) => { if(e.key === 'Enter') handleSend(); });

        logo.onerror = function() {
            this.style.display = 'none';
            const fallback = document.createElement('div');
            fallback.style.cssText = "width:40px; height:40px; border:4px solid #00d2ff; border-radius:50%; border-top:4px solid transparent; animation:fastSpin 1s linear infinite;";
            this.parentNode.insertBefore(fallback, this);
        };
    </script>
</body>
</html>